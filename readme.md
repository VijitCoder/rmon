## Монитор Redis
Функционал был запилен в Yii 1.16. Активно использовали хеши, в которых описывались объекты. Так же строки, сериализация данных. Разработку похерили. Попытался спасти, создав максимально переносимый код.

Возможности монитора: просмотр содержимого кешей с фильтрацией по ключам/ttl. Обновление ttl, удаление кешей по маске. [Скриншот монитора](https://github.com/VijitCoder/rmon/blob/master/monitor_shot.jpg)

Возможности Redis-клиента: все, что позволяет сервер. Несколько функций оформлены отдельно, как часто используемые. Но в принципе, можно заслать любую команду Redis-серверу. Пример команды без функциональной обертки:

```
yii::app()->rmon->execute(['SETEX', 'test', 3000, 'some_value']); //запись строки в кеш, ttl = 5 мин
```

**RedisSocWrapper.php** - "рабочая лошадь". Подключалась, как компонент Yii. Пример подключения:
```PHP
return array(
    ...
    'components'=>array(
        ...
        'redis' => array(
            'class' => 'RedisSocWrapper',
            'off' => false,                   //не отключать использование redis-кеша
            'strict' => !Env::isProduction(), //на проде не прерывать скрипт, если ошибки с Redis
           // 'log_level' => 2,                 //0 - отключить логирование, 4 - максимум инфы. Рекомендуемый: 1-2
        ),
    ),
);
```
Логирование выпилил, чтоб было проще понять идею. К тому же с появлением монитора необходимость логирования практически исчезла. Тем не менее, версия с логом доступна в скрипте **RedisSocWrapper_log.php**

Из типов *Redis* на сайте использовали `hash` и `string`, поэтому отдельный функционал только для них.

Одним из требований была установка ttl кеша = 300 сек. Когда ttl становится меньше 120сек, чтение кеша возвращает `false` и продлевает время жизни на 120сек. Зачем? Клиентский код, не получив данные из кеша должен инициировать его обновление. Пока оно идет, другие запросы будут получать старый кеш с продленным временем жизни.

Для работы монитора требуется **jQuery**. Так же желательно подключить *jQuery.UI*, чтобы работал плагин "*accordion*" в верхней части шаблона.

В коде настроен перманентный фильтр для исключения из мониторинга некоторых ключей. Его можно использовать, как пример для вашего фильтра. Сам код описан в **RedisMonService::_clearKeys()**
